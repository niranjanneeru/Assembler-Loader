FIRST STL RETADR
CLOOP JSUB RDREC
(null) LDA LENGTH
(null) COMP ZERO
(null) JEQ ENDFIL
(null) JSUB WRREC
(null) J CLOOP
ENDFIL LDA EOF
(null) STA BUFFER
(null) LDA THREE
(null) STA LENGTH
(null) JSUB WRREC
(null) LDL RETADR
(null) RSUB (null)
EOF BYTE C'EOF'
THREE WORD 3
ZERO WORD 0
RETADR RESW 1
LENGTH RESW 1
BUFFER RESB 4096
RDREC LDX ZERO
(null) LDA ZERO
RLOOP TD INPUT
(null) JEQ RLOOP
(null) RD INPUT
(null) COMP ZERO
(null) JEQ EXIT
(null) STCH BUFFER,X
(null) TIX MAXLEN
(null) JLT RLOOP
EXIT STX LENGTH
(null) RSUB (null)
INPUT BYTE X'F1'
MAXLEN WORD 4096
WRREC LDX ZERO
WLOOP TD OUTPUT
(null) JEQ WLOOP
(null) LDCH BUFFER,X
(null) WD OUTPUT
(null) TIX LENGTH
(null) JLT WLOOP
(null) RSUB (null)
. M3 C
(null) LDA C
(null) MEND (null)
. M3 W
(null) LDA W
(null) MEND (null)
OUTPUT BYTE X'05'
(null) LDA A
. M1 S,T,U,V
(null) LDA S
(null) LDA T
(null) MEND (null)
(null) END (null)
